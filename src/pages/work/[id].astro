---
import Page from "../../comp/Page.astro";

export async function getStaticPaths() {
  const mdxs = await Astro.glob("../../content/work/*.md");
  const list = mdxs.map((md) => ({
    params: {
      id: md.frontmatter.id,
    },
    props: {
      markdown: md,
    },
  }));
  return list;
}

const { markdown } = Astro.props;
const { id, title, url, imgs } = markdown.frontmatter;
const { Content } = markdown;
---

<Page>
  <style is:global>
    body {
      background: rgb(49, 49, 49);
    }
  </style>
  <script is:inline></script>
  <div
    class="_content-grid px-10 mx-auto max-w-[1200px]"
    x-data={`{ ix:0, imgs: ${JSON.stringify(imgs)} }`}
    @keydown.window.escape="window.history.back()"
  >
    <header>
      <div class="h-14 flex flex-row justify-between items-center">
        <a
          href="/portfolio/about"
          @click.prevent="window.history.back()"
          aria-label="Back"
          class="p-3"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="rotate-180"
          >
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
        <h1 class="heading text-xl">{title}</h1>
        <a
          href="/portfolio/about"
          @click.prevent="window.history.back()"
          aria-label="close"
          class="p-3"
        >
          X
        </a>
      </div>
    </header>

    <main class="mt-10 h-[80vh] max-h-[800px]">
      <div class="relative flex flex-row justify-center items-center">
        <img
          class=""
          src={`/portfolio/work/${imgs[0]}`}
          alt={`${id} website image`}
          transition:name={`${id}-img`}
          x-show="ix===0"
        />
        <template x-for="(img,i) in imgs">
          <img
            class=""
            :src="'/portfolio/work/'+img"
            alt={`${id} website image`}
            x-show="i!==0 && ix===i"
            transition:name={`${id}-img`}
          />
        </template>
      </div>
      <div
        class="mt-3 flex flex-row justify-center gap-3"
        x-show="imgs.length > 1"
      >
        <template x-for="(img,i) in imgs">
          <button @click="ix=i" class="w-10 h-10 rounded-full bg-gray-300"
          ></button>
        </template>
      </div>
      <div>
        <p>
          url :
          <a href={url}>
            {url}
          </a>
        </p>

        <div class="md">
          <Content />
        </div>
      </div>
    </main>
  </div>
</Page>

<style is:global>
  .md ul {
    padding-left: 1.5rem;
    list-style: disc;
  }
</style>
